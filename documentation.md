# VKinder
**Vkinder** - это приложение ВКонтакте для знакомств. Представляет собой чат-бот, позволяющий находить людей, используя информацию (возраст, пол, город) о пользователе, который общается с ботом

### Настройка
Перед запуском стартового модуля **teamwork.py** необходимо:
1. Создать сообщество Вконтакте и получить токен сообщества в настройках
2. Создать базу данных, используя СУБД Postgres
3. Требуется установить библиотеки командой:  
`pip intstall -r requirements.txt`
4. Задать следующие переменные окружения в файле **.env**:

| Имя переменной | Описание значения переменной                      |
|----------------|---------------------------------------------------|
| VK_TOKEN       | Ключ сообщества (Access token), полученный в настройках сообщества                                                  |
| NAME_DB        | Имя базы данных                                   |
| USER_DB        | Имя пользователя для подключения к базе данных    |
| PASSWORD_DB    | Пароль пользователя для подключения к базе данных |
| HOST_DB        | Название хоста для подключения в базе данных      |
| POST_DB        | Порт для подключения к базе данных                |
|                |                                                   |

### Команды бота

**“найти человека”** – осуществляется поиск пользователей по следующим параметрам:
пол, противоположный полу пользователя ботом
город пользователя ботом
возраст пользователя ботом
В результате поиска в чат бот выведет фамилию, имя первого найденного пользователя, ссылку на его профиль ВК, а также топ-3 фото его профиля.

**“добавить избранное”** – добавление пользователя в список избранных. В базе данных это таблица 'favorites'.

**“список избранных”** – выводит в чат список избранных по форме: ссылка на профиль, имя и фамилия

**“следующий”** – переход к следующему из найденных пользователей.

**"помощь"** - выводит в чат доступные команды для управления ботом


### Модули
**teamwork** - основной модуль, используется для запуска бота

-`create_main_keyboard():`

-`create_search_keyboard():`

-`write_msg(user_id, message, keyboard = None, attachment = None)`

-`handle_find_person(user_id)`

-`handle_next_person(user_id)`

-`handle_add_favorite(user_id)`

-`handle_list_favorites(user_id)`


**database** - предназначен для работы с базой данных
`class DataBase()` - класс позволяет создать экземпляр класса, применять к нему методы для управления Базой данных



**vk_integration** - модуль для вазимодействия с VK API

`class VKInteraction` - с помощью данного класса можно создать экземпляр и применять к нему методы работы с VK API

-`get_user_info()` - используя параметры user_id - ID пользователя  и fields - дополнительные поля, возращает словарь с информацией о пользователе

-`user_search()` - используя параметры age_from -минимальный возраст, age_to - максимальный возраст, sex - Пол (1 - женский, 2 - мужской), 
city - ID города, count - количество возвращаемых людей (макс. 1000), возращает список людей подходящих под парамметры. в случае ошибки возвращает пустой список


-`get_user_photos()` - используя параметры user_id - ID полизователя VK, count - количество фотографий, 
возвращает список Attachment фотографий или пустой список в случае ошибки

**get_token** - модуль для получения токена пользователя

- `def get_token_with_selenium()` - фукнция, возвращающая user_token -токен пользователя. Формирует URL для OAuth-авторизации в VK, использует библиотеки selenium и webdriver_manager



